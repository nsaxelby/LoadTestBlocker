<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <script>
        var ws;

        window.addEventListener("load", function (evt) {
            document.getElementById("startform").onsubmit = function () {
                startTest();
                return false
            };

            document.getElementById("stopform").onsubmit = function () {
                stopTest();
                return false
            };

            if (window["WebSocket"]) {
                if (ws) {
                    return false;
                }
                ws = new WebSocket("ws://" + window.location.hostname + ":8080/ws");
                ws.onopen = function (evt) {
                    addMessage("opened")
                }
                ws.onclose = function (evt) {
                    addMessage("closed")
                    ws = null;
                }
                ws.onmessage = function (evt) {
                    addMessage(evt.data)
                }
                ws.onerror = function (evt) {
                    addMessage("error: " + evt.data)
                }
                return false;
            }
            else {
                addMessage("Your browser does not support websockets")
            }

        });

        function addMessage(msg) {
            var newValue = document.getElementById('mylog').value + "\n" + msg;
            document.getElementById('mylog').value = newValue
        }

        function startTest() {
            if (!ws) {
                return
            }

            ws.send("start");
        }

        function stopTest() {
            if (!ws) {
                return
            }

            ws.send("stop");
        }
    </script>
</head>

<body>
    <textarea id="mylog">
    </textarea>
    <form id="startform">
        <input type="submit" value="Start Test" />
    </form>
    <form id="stopform">
        <input type="submit" value="Stop Test" />
    </form>
</body>

</html>