<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <script>
        var ws;

        window.addEventListener("load", function (evt) {
            document.getElementById("form").onsubmit = function () {
                if (!ws) {
                    return false;
                }

                ws.send("button pressed");
                return false;
            };


            if (window["WebSocket"]) {
                if (ws) {
                    return false;
                }
                ws = new WebSocket("ws://" + window.location.hostname + ":8080/ws");
                ws.onopen = function (evt) {
                    addMessage("opened")
                }
                ws.onclose = function (evt) {
                    addMessage("closed")
                    ws = null;
                }
                ws.onmessage = function (evt) {
                    addMessage(evt.data)
                }
                ws.onerror = function (evt) {
                    addMessage("error: " + evt.data)
                }
                return false;
            }
            else {
                addMessage("Your browser does not support websockets")
            }

        });

        function addMessage(msg) {
            var newValue = document.getElementById('mylog').value + "\n" + msg;
            document.getElementById('mylog').value = newValue
        }
    </script>
</head>

<body>
    <textarea id="mylog">
    </textarea>
    <form id="form">
        <input type="submit" value="Start Test" />
    </form>
</body>

</html>